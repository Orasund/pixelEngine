<!DOCTYPE html><html><head><meta charset="utf-8"><title>TicTacToe Example</title><style media="screen">body{font-family:Helvetica,sans-serif;display:flex}main{order:1}aside{width:300px}aside ul{padding:0}aside li{list-style-type:none;margin:10px}aside li.active a{text-decoration:none}iframe{border:1px solid #000}hr:first-of-type{display:none}.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-built_in,.hljs-class .hljs-title{color:#c18401}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style></head><body><main><h1>TicTacToe</h1><iframe frameborder="1" height="504" src="iframe.html" width="990"></iframe><hr><h3>TicTacToe</h3><div class="description"></div><pre><code class="elm"><span class="hljs-keyword">module</span> TicTacToe <span class="hljs-keyword">exposing</span> ( main )

<span class="hljs-keyword">import</span> Dict <span class="hljs-keyword">exposing</span> (<span class="hljs-type">Dict</span>)
<span class="hljs-keyword">import</span> PixelEngine <span class="hljs-keyword">exposing</span> (<span class="hljs-type">PixelEngine</span>,gameWithNoControls)
<span class="hljs-keyword">import</span> PixelEngine.Controls <span class="hljs-keyword">exposing</span> (<span class="hljs-type">Input(..)</span>)
<span class="hljs-keyword">import</span> PixelEngine.Graphics <span class="hljs-keyword">as</span> Graphics <span class="hljs-keyword">exposing</span> (<span class="hljs-type">Area</span>, <span class="hljs-type">Background</span>, <span class="hljs-type">Options</span>)
<span class="hljs-keyword">import</span> PixelEngine.Graphics.Tile <span class="hljs-keyword">as</span> Tile <span class="hljs-keyword">exposing</span> (<span class="hljs-type">Tile</span>, <span class="hljs-type">Tileset</span>, tile)



<span class="hljs-comment">{------------------------
   TYPES
------------------------}</span>


<span class="hljs-keyword">type</span> <span class="hljs-type">Mark</span>
    = <span class="hljs-type">Nought</span>
    | <span class="hljs-type">Cross</span>


<span class="hljs-keyword">type</span> <span class="hljs-keyword">alias</span> <span class="hljs-type">Grid</span> =
    <span class="hljs-type">Dict</span> ( <span class="hljs-type">Int</span>, <span class="hljs-type">Int</span> ) <span class="hljs-type">Mark</span>


<span class="hljs-keyword">type</span> <span class="hljs-keyword">alias</span> <span class="hljs-type">Model</span> =
    { grid : <span class="hljs-type">Grid</span>
    , nextMark : <span class="hljs-type">Mark</span>
    }


<span class="hljs-keyword">type</span> <span class="hljs-type">Msg</span>
    = <span class="hljs-type">PlaceMark</span> ( <span class="hljs-type">Int</span>, <span class="hljs-type">Int</span> )
    | <span class="hljs-type">Reset</span>



<span class="hljs-comment">{------------------------
   INIT
------------------------}</span>


<span class="hljs-title">newGame</span> : <span class="hljs-type">Model</span>
<span class="hljs-title">newGame</span> =
    { grid = <span class="hljs-type">Dict</span>.empty
    , nextMark = <span class="hljs-type">Cross</span>
    }


<span class="hljs-title">init</span> : () -&gt; ( <span class="hljs-type">Model</span>, <span class="hljs-type">Cmd</span> <span class="hljs-type">Msg</span> )
<span class="hljs-title">init</span> _ =
    ( newGame
    , <span class="hljs-type">Cmd</span>.none
    )



<span class="hljs-comment">{------------------------
   UPDATE
------------------------}</span>


<span class="hljs-title">flip</span> : <span class="hljs-type">Mark</span> -&gt; <span class="hljs-type">Mark</span>
<span class="hljs-title">flip</span> mark =
    <span class="hljs-keyword">case</span> mark <span class="hljs-keyword">of</span>
        <span class="hljs-type">Nought</span> -&gt;
            <span class="hljs-type">Cross</span>

        <span class="hljs-type">Cross</span> -&gt;
            <span class="hljs-type">Nought</span>


<span class="hljs-title">update</span> : <span class="hljs-type">Msg</span> -&gt; <span class="hljs-type">Model</span> -&gt; ( <span class="hljs-type">Model</span>, <span class="hljs-type">Cmd</span> <span class="hljs-type">Msg</span> )
<span class="hljs-title">update</span> msg ({ grid, nextMark } <span class="hljs-keyword">as</span> model) =
    <span class="hljs-keyword">let</span>
        defaultCase : ( <span class="hljs-type">Model</span>, <span class="hljs-type">Cmd</span> <span class="hljs-type">Msg</span> )
        defaultCase =
            ( model, <span class="hljs-type">Cmd</span>.none )
    <span class="hljs-keyword">in</span>
    <span class="hljs-keyword">case</span> msg <span class="hljs-keyword">of</span>
        <span class="hljs-type">PlaceMark</span> ( x, y ) -&gt;
            <span class="hljs-keyword">if</span> x &gt;= <span class="hljs-number">0</span> &amp;&amp; x &lt; <span class="hljs-number">3</span> &amp;&amp; y &gt;= <span class="hljs-number">0</span> &amp;&amp; y &lt; <span class="hljs-number">3</span> <span class="hljs-keyword">then</span>
                <span class="hljs-keyword">case</span> grid |&gt; <span class="hljs-type">Dict</span>.get ( x, y ) <span class="hljs-keyword">of</span>
                    <span class="hljs-type">Nothing</span> -&gt;
                        ( { grid = grid |&gt; <span class="hljs-type">Dict</span>.insert ( x, y ) nextMark
                          , nextMark = flip nextMark
                          }
                        , <span class="hljs-type">Cmd</span>.none
                        )

                    <span class="hljs-type">Just</span> _ -&gt;
                        defaultCase

            <span class="hljs-keyword">else</span>
                <span class="hljs-comment">{- It is not a good coding practice to have dead branches like
                   this one, but fixing it would blow up this short example.
                   Check out https://www.youtube.com/watch?v=IcgmSRJHu_8 why
                   impossible states are bad.
                -}</span>
                defaultCase

        <span class="hljs-type">Reset</span> -&gt;
            ( newGame, <span class="hljs-type">Cmd</span>.none )



<span class="hljs-comment">{------------------------
   SUBSCRIPTIONS
------------------------}</span>


<span class="hljs-title">subscriptions</span> : <span class="hljs-type">Model</span> -&gt; <span class="hljs-type">Sub</span> <span class="hljs-type">Msg</span>
<span class="hljs-title">subscriptions</span> _ =
    <span class="hljs-type">Sub</span>.none


<span class="hljs-comment">{------------------------
   VIEW
------------------------}</span>
<span class="hljs-title">none</span> : ( <span class="hljs-type">Int</span>, <span class="hljs-type">Int</span> ) -&gt; <span class="hljs-type">Tile</span> <span class="hljs-type">Msg</span>
<span class="hljs-title">none</span> pos =
    tile ( <span class="hljs-number">0</span>, <span class="hljs-number">0</span> )
        |&gt; <span class="hljs-type">Tile</span>.withAttributes [ <span class="hljs-type">Tile</span>.onClick (<span class="hljs-type">PlaceMark</span> pos) ]

<span class="hljs-title">nought</span> : <span class="hljs-type">Tile</span> <span class="hljs-type">Msg</span>
<span class="hljs-title">nought</span> =
    tile ( <span class="hljs-number">0</span>, <span class="hljs-number">1</span> )

<span class="hljs-title">cross</span> : <span class="hljs-type">Tile</span> <span class="hljs-type">Msg</span>
<span class="hljs-title">cross</span> =
    tile ( <span class="hljs-number">1</span>, <span class="hljs-number">1</span> )

<span class="hljs-title">reset</span> : <span class="hljs-type">Tile</span> <span class="hljs-type">Msg</span>
<span class="hljs-title">reset</span> =
    tile ( <span class="hljs-number">1</span>, <span class="hljs-number">0</span> ) |&gt; <span class="hljs-type">Tile</span>.withAttributes [ <span class="hljs-type">Tile</span>.onClick <span class="hljs-type">Reset</span> ]

<span class="hljs-title">getTile</span> : ( <span class="hljs-type">Int</span>, <span class="hljs-type">Int</span> ) -&gt; <span class="hljs-type">Grid</span> -&gt; <span class="hljs-type">Tile</span> <span class="hljs-type">Msg</span>
<span class="hljs-title">getTile</span> ( x, y ) grid =
    <span class="hljs-keyword">case</span> grid |&gt; <span class="hljs-type">Dict</span>.get ( x, y ) <span class="hljs-keyword">of</span>
        <span class="hljs-type">Just</span> <span class="hljs-type">Nought</span> -&gt;
            nought

        <span class="hljs-type">Just</span> <span class="hljs-type">Cross</span> -&gt;
            cross

        <span class="hljs-type">Nothing</span> -&gt;
            none ( x, y )


<span class="hljs-title">foldOverGrid</span> : { width : <span class="hljs-type">Int</span>, height : <span class="hljs-type">Int</span> } -&gt; (( <span class="hljs-type">Int</span>, <span class="hljs-type">Int</span> ) -&gt; a) -&gt; <span class="hljs-type">List</span> a
<span class="hljs-title">foldOverGrid</span> { width, height } function =
    <span class="hljs-type">List</span>.range <span class="hljs-number">0</span> (width - <span class="hljs-number">1</span>)
        |&gt; <span class="hljs-type">List</span>.foldl
            (\x list -&gt;
                <span class="hljs-type">List</span>.range <span class="hljs-number">0</span> (height - <span class="hljs-number">1</span>)
                    |&gt; <span class="hljs-type">List</span>.foldl
                        (\y -&gt; <span class="hljs-type">List</span>.append [ function ( x, y ) ])
                        list
            )
            []


<span class="hljs-title">view</span> : <span class="hljs-type">Model</span> -&gt; { title : <span class="hljs-type">String</span>, options : <span class="hljs-type">Options</span> <span class="hljs-type">Msg</span>, body : <span class="hljs-type">List</span> (<span class="hljs-type">Area</span> <span class="hljs-type">Msg</span>) }
<span class="hljs-title">view</span> { grid } =
    <span class="hljs-keyword">let</span>
        tileSize : <span class="hljs-type">Int</span>
        tileSize =
            <span class="hljs-number">16</span>

        windowWidth : <span class="hljs-type">Int</span>
        windowWidth =
            <span class="hljs-number">5</span>

        width : <span class="hljs-type">Float</span>
        width =
            toFloat &lt;| windowWidth * tileSize

        tileset : <span class="hljs-type">Tileset</span>
        tileset =
            { source = <span class="hljs-string">"tileset.png"</span>
            , spriteWidth = tileSize
            , spriteHeight = tileSize
            }

        background : <span class="hljs-type">Background</span>
        background =
            <span class="hljs-type">Graphics</span>.imageBackground
                { height = <span class="hljs-number">80</span>
                , width = <span class="hljs-number">80</span>
                , source = <span class="hljs-string">"background.png"</span>
                }
    <span class="hljs-keyword">in</span>
    { title = <span class="hljs-string">"Tic Tac Toe"</span>
    , options = <span class="hljs-type">Graphics</span>.options { width = width, transitionSpeedInSec = <span class="hljs-number">0.2</span> }
    , body =
        [ <span class="hljs-type">Graphics</span>.tiledArea
            { rows = <span class="hljs-number">5</span>
            , tileset = tileset
            , background = background
            }
            (foldOverGrid
                { width = <span class="hljs-number">3</span>, height = <span class="hljs-number">3</span> }
                (\(( x, y ) <span class="hljs-keyword">as</span> pos) -&gt;
                    ( ( <span class="hljs-number">1</span> + x, <span class="hljs-number">1</span> + y )
                    , grid |&gt; getTile pos
                    )
                )
                |&gt; <span class="hljs-type">List</span>.append
                    [ ( ( <span class="hljs-number">2</span>, <span class="hljs-number">0</span> ), reset ) ]
            )
        ]
    }



<span class="hljs-comment">{------------------------
   MAIN
------------------------}</span>

<span class="hljs-title">main</span> : <span class="hljs-type">PixelEngine</span> () <span class="hljs-type">Model</span> <span class="hljs-type">Msg</span>
<span class="hljs-title">main</span> =
    gameWithNoControls
        { init = init
        , update = update
        , subscriptions = subscriptions
        , view = view
        }
</code></pre></main><aside><h2>Examples</h2><ul><li><a href="../Animations">Animations</a></li><li><a href="../Controls">Controls</a></li><li><a href="../Render">Render</a></li><li class="active"><a href="../TicTacToe">TicTacToe</a></li></ul></aside><script type="application/javascript">("serviceWorker"in navigator&&"localhost"!==location.hostname||"127.0.0.1"!==location.hostname)&&navigator.serviceWorker.register("../service-worker.js")</script></body></html>